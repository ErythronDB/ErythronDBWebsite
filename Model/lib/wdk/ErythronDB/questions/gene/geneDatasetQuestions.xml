<wdkModel>
  <questionSet name="GeneDataset" displayName="Search for Genes by Dataset">
    <question name="DifferentialExpression" urlName="diffexp" displayName="Differential Expression" shortDisplayName="FC" queryRef="GeneDatasets.DifferentialExpression" recordClassRef="GeneRecordClasses.GeneRecordClass">

      <paramRef groupRef="paramGroups.dynamicParams" ref="geneParams.investigation" default="study001" queryRef="GeneVQ.TranscriptomicsInvestigations"/>
      <paramRef groupRef="paramGroups.dynamicParams" ref="geneParams.experiment" queryRef="GeneVQ.Experiments"/>
      <paramRef groupRef="paramGroups.dynamicParams" ref="geneParams.transcriptomics_ref_condition" />
      <paramRef groupRef="paramGroups.dynamicParams" ref="geneParams.transcriptomics_alt_condition" />

      <attributesList summary="product,fold_change,adj_p_value,reference_mean,alternative_mean,log2_fold_change,confidence_interval,cell_or_lineage,ref_condition,alt_condition" sorting="fold_change desc" />
      <summary>
        <![CDATA[
		        Find genes which are differentially expressed in a Transcriptomics experiment.
        ]]>
      </summary>

      <description>
        <![CDATA[
              <p>Find genes which are differentially expressed in a transcriptomics experiment.  First choose an experiment as the available comparisons may change.  If only one "Experiment" is available, this field will be selected for you.</p>

              <p>Choose the directionality and the magnitude of the difference.  </br>
                 For example, selecting up-regulated with a fold difference of 2 will only show results where the intensity of the comparator is twice that of the reference. </p>
        ]]>
      </description>


      <dynamicAttributes>
        <columnAttribute name="cell_or_lineage" displayName="Dataset" />
        <columnAttribute name="ref_condition" displayName="Reference" help="reference condition for the comparison"/>
        <columnAttribute name="alt_condition" displayName="Alternative" help="alternative condition for the comparison"/>
        <columnAttribute name="log2_fold_change" displayName="Log2 FC" align="center" inReportMaker="false" help="log2 fold change"/>
        <columnAttribute name="log2_reference_mean" displayName="Log2 Ref Mean" help="mean log2 mRNA expression level for the reference condition" align="center"/>
        <columnAttribute name="log2_alternative_mean" displayName="Log2 Alt Mean" help="mean log2 mRNA expression level for the alternate, comparison condition" align="center"/>
        <columnAttribute name="fold_change" displayName="Raw FC" align="center" inReportMaker="false" help="fold change based on raw mRNA expression levels"/>
        <columnAttribute name="reference_mean" displayName="Ref Mean" help="mean mRNA expression level for the reference condition" align="center"/>
        <columnAttribute name="alternative_mean" displayName="Alt Mean" help="mean mRNA expression level for the alternate, comparison condition" align="center"/>
        <columnAttribute name="confidence_interval" align="center" displayName="Conf. Interval" help="[log2 lower, log2 upper] 95% confidence interval on fold change.  Most useful for interpreting fold changes less/greater than +/-2.  If the interval is broad or lower and upper limits have opposing signs, then the there is less confidence in the fold change value."/>
        <columnAttribute name="adj_p_value" align="center" displayName="Adj. p-value" help="BH-adjusted p-value (q-value)"/>

      </dynamicAttributes>

    </question>

    <question name="GenesByProteomicsComparison" urlName="FC003" displayName="Differential Intensity" shortDisplayName="Proteomics FC" queryRef="GeneDatasets.ProteomicsFC" recordClassRef="GeneRecordClasses.GeneRecordClass" iconName="fa fa-exchange fa-rotate-90" newBuild="2">

      <attributesList summary="product,fold_change,reference_mean,alternative_mean" sorting="fold_change desc" />


      <paramRef groupRef="paramGroups.dynamicParams" ref="geneParams.investigation" queryRef="GeneVQ.ProteomicsInvestigations"/>

      <summary>
        <![CDATA[
    		 Find genes which are differentially expressed in a Proteomics experiment.
        		]]>
      </summary>

      <description>
        <![CDATA[
    		 Find genes which are differentially expressed in a Proteomics experiment.  First choose an experiment as the available comparisons may change.  If only one "Experiment" is shown, this field will be selected for you.
    		 <br/><br/>
    		Choose the directionality and the magnitude of the difference.  For example, selecting up-regulated with a fold difference of 2 will only show results where the intensity of the comparator is twice that of the reference.
    		 <br /><br/>
        		]]>
      </description>

      <dynamicAttributes>
        <columnAttribute name="fold_change" displayName="Fold Change" align="center" inReportMaker="false" help=""/>
        <columnAttribute name="reference_mean" displayName="Ref (Log2 Mean Intensity)" help="mean log2 intensity for the reference condition" align="center"/>
        <columnAttribute name="alternative_mean" displayName="Alt (Log2 Mean Intensity)" help="mean log2 intensity for the alternate, comparison condition" align="center"/>

      </dynamicAttributes>

      <propertyList name="displayCategory">
        <value>fold_change</value>
      </propertyList>


    </question>


    <question name="RankedExpression" urlName="rank" displayName="Ranked Expression Level" shortDisplayName="Gene Exp" queryRef="GeneDatasets.RankedExpression" recordClassRef="GeneRecordClasses.GeneRecordClass" newBuild="2" iconName="fa fa-sort-amount-desc">

      <paramRef groupRef="paramGroups.dynamicParams" ref="geneParams.investigation" default="study001" queryRef="GeneVQ.TranscriptomicsInvestigations"/>
      <paramRef groupRef="paramGroups.dynamicParams" ref="geneParams.experiment" queryRef="GeneVQ.Experiments"/>

      <attributesList summary="product,percentile,mean_expression,standard_error" sorting="mean_expression desc"/>

      <summary>
        <![CDATA[
    		 Find expressed genes in a transcriptomics dataset.
    	]]>
      </summary>
      <description>
        <![CDATA[[
    		   Find genes by ranked expression level in a transcriptomics dataset.  First choose an experiment as the available samples may change.  If only one "Experiment" is available, this field will be selected for you.
    	  ]]>
      </description>

      <dynamicAttributes>
        <columnAttribute name="sample" displayName="Sample" align="center" inReportMaker="false" help="sample associated with top-ranked expression (out of selected samples in search)"/>
        <columnAttribute name="percentile" displayName="Percentile" align="center" inReportMaker="false" help="ranked percentile across all genes expressed in this condition for the experiment"/>
        <columnAttribute name="mean_expression" displayName="Log2 Mean Expression" help="mean log2 mRNA expression level  for the selected condition" align="center"/>
        <columnAttribute name="standard_error" displayName="Std Error" help="standard error on the mean log2 expression" align="center"/>

      </dynamicAttributes>
    </question>
  </questionSet>


</wdkModel>
