<?xml version="1.0" encoding="UTF-8"?>
<wdkModel>
	<querySet name="DatasetTables" queryType="table" isCacheable="false">
		<sqlQuery name="All">
			<column name="dataset_id"/>

			<sql>
				<![CDATA[
		 SELECT source_id AS dataset_id
		 FROM ErythronDB.Dataset
	]]>
			</sql>
		</sqlQuery>


		<sqlQuery name="Datasets">
			<column name="dataset_id"/>
			<column name="child_dataset_id"/>
			<column name="project_id"/>
			<column name="category"/>
			<column name="taxon"/>
			<column name="dataset_name"/>
			<column name="dataset_summary"/>
			<column name="fc_link"/>
			<column name="p_link"/>
			<column name="highlight"/>

			<sql>
				<![CDATA[
					SELECT investigation_id AS dataset_id,
					dataset_id AS child_dataset_id,
					'@PROJECT_ID@'::text AS project_id,
					category,
					taxon,
					dataset_name,
					dataset_summary,
					is_public,
					'<a href="/@WEBAPP@/' || split_part(p_link, '//', 1) || '&' || 'investigation=' || investigation_id || '&' || 'experiment=' || dataset_id || '">' || split_part(p_link, '//', 2) || '</a>' AS p_link,
					'<a href="/@WEBAPP@/' || split_part(fc_link, '//', 1) || '&' || 'investigation=' || investigation_id || '&' || 'experiment=' || dataset_id || '">' || split_part(fc_link, '//', 2) || '</a>' AS fc_link,
					'coming soon' AS highlight
					FROM ErythronDB.Dataset
					ORDER BY dataset_id, child_dataset_id
				]]>
			</sql>
		</sqlQuery>

	</querySet>
</wdkModel>
